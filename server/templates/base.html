<!doctype html>
<html>
<head>
    <title>{{ meta.title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 

    <meta name="author" content="{{ meta.author }}"/>
    <meta name="description" content="{{ meta.description }}"/>
    <meta name="keywords" content="{{ meta.keywords.join(', ') }}"/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@MeSoSupe"/>
    <meta name="twitter:title" content="{{ meta.title }}"/>
    <meta name="twitter:description" content="{{ meta.description }}"/>
    <meta name="twitter:image" content="{{ getAbsoluteUrl('assets/static/LogoDiamond_192.png') }}"/>

    <meta property="og:title" content="{{ meta.title }}"/>
    <meta property="og:description" content="{{ meta.description }}"/>
    <meta property="og:url" content="{{ getAbsoluteUrl(meta.path) }}">
    <meta property="og:site_name" content="{{ meta.websiteName }}"/>
    <meta property="og:image" content="{{ getAbsoluteUrl('assets/static/LogoDiamond_192.png') }}"/>

    <link rel="canonical" itemprop="url" href="{{ getAbsoluteUrl(meta.path) }}"/>
    <link rel="shortcut icon" type="image/png" href="/assets/static/LogoDiamond_48.png"/>
    <link rel="alternate" type="application/rss+xml" title="{{meta.title}}" href="{{ getAbsoluteUrl('rss.xml') }}"/>

    <script type="text/javascript">
        // Load a polyfill if we're missing important elements
        
        // the loadScript is from https://philipwalton.com/articles/loading-polyfills-only-when-needed/
        function loadScript(src, done) {
            var js = document.createElement('script');
            js.src = src;
            js.onload = function() {
                if (done) done();
            };
            js.onerror = function() {
                if (done) done(new Error('Failed to load script ' + src));
            };
            document.head.appendChild(js);
        }

        var features = ['Promise', 'fetch', 'Symbol', 'Set'];
        for (var i in features) {
            if (!window[features[i]]) {
                console.log("Loading polyfill");
                loadScript("{{ getAsset('polyfill.js') }}", function (err) {
                    if (err) {
                        console.error(err);
                    } else {
                        console.log("Loaded polyfill");
                    }
                });

                break;
            }
        }
    </script>

    <link href="{{ getAsset('app.css') }}" rel="stylesheet"/>
</head>
<body>
    <!--[if lte IE 9]>
    <div id="unsupported-browser">
        <div class='content'>
            <h2>Unfortunately, your web browser is not supported.</h2>
            Internet Explorer 9 and below are not supported.<br>
            Please update Internet Explorer or switch to 
            <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a>
            or <a href="https://www.google.com/chrome/browser/desktop/index.html">Chrome</a>
        </div>
    </div>
    <![endif]-->

    <![if gt IE 9]>
    <div id="website-root">{{ renderedHtml | safe}}</div>
    <![endif]>

    {% if initialState %}
    <script type="text/javascript">
        // http://redux.js.org/docs/recipes/ServerRendering.html
        window.__PRELOADED_STATE__ = {{ initialState | dump | safe}}
    </script>
    {% endif %}
    <script src="{{ getAsset('app.js') }}" type="text/javascript"></script>
</body>
</html>
